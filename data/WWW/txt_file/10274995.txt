towards context-aware search by learning a very large variable length hidden markov model from search logs capturing the context of a user 's query from the previous queries and clicks in the same session may help understand the user 's information need . a context-aware approach to document re-ranking , query suggestion , and url recommendation may improve users ' search experience substantially . in this paper , we propose a general approach to context-aware search . to capture contexts of queries , we learn a variable length hidden markov model ( vlhmm ) from search sessions extracted from log data . although the mathematical model is intuitive , how to learn a large vlhmm with millions of states from hundreds of millions of search sessions poses a grand challenge . we develop a strategy for parameter initialization in vlhmm learning which can greatly reduce the number of parameters to be estimated in practice . we also devise a method for distributed vlhmm learning under the map-reduce model . we test our approach on a real data set consisting of 1.8 billion queries , 2.6 billion clicks , and 840 million search sessions , and evaluate the effectiveness of the vlhmm learned from the real data on three search applications : document re-ranking , query suggestion , and url recommendation . the experimental results show that our approach is both effective and efficient . 