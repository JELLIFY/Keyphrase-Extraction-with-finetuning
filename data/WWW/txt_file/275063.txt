to randomize or not to randomize : space optimal summaries for hyperlink analysis personalized pagerank expresses link-based page quality around user selected pages . the only previous personalized pagerank algorithm that can serve on-line queries for an unrestricted choice of pages on large graphs is our monte carlo algorithm ( waw 2004 ) . in this paper we achieve unrestricted personalization by combining rounding and randomized sketching techniques in the dynamic programming algorithm of jeh and widom ( www 2003 ) . we evaluate the precision of approximation experimentally on large scale real-world data and find significant improvement over previous results . as a key theoretical contribution we show that our algorithms use an optimal amount of space by also improving earlier asymptotic worst-case lower bounds . our lower bounds and algorithms apply to the simrank as well ; of independent interest is the reduction of the simrank computation to personalized pagerank . 