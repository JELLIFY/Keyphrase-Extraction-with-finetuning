detection and analysis of drive-by-download attacks and malicious javascript code javascript is a browser scripting language that allows developers to create sophisticated client-side interfaces for web applications . however , javascript code is also used to carry out attacks against the user 's browser and its extensions . these attacks usually result in the download of additional malware that takes complete control of the victim 's platform , and are , therefore , called `` drive-by downloads . '' unfortunately , the dynamic nature of the javascript language and its tight integration with the browser make it difficult to detect and block malicious javascript code . this paper presents a novel approach to the detection and analysis of malicious javascript code . our approach combines anomaly detection with emulation to automatically identify malicious javascript code and to support its analysis . we developed a system that uses a number of features and machine-learning techniques to establish the characteristics of normal javascript code . then , during detection , the system is able to identify anomalous javascript code by emulating its behavior and comparing it to the established profiles . in addition to identifying malicious code , the system is able to support the analysis of obfuscated code and to generate detection signatures for signature-based systems . the system has been made publicly available and has been used by thousands of analysts . 