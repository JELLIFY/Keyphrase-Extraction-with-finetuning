alhambra : a system for creating , enforcing , and testing browser security policies alhambra is a browser-based system designed to enforce and test web browser security policies . at the core of alhambra is a policy-enhanced browser supporting fine-grain security policies that restrict web page contents and execution . alhambra requires no server-side modifications or additions to the web application . policies can restrict the construction of the document as well as the execution of javascript using access control rules and a taint-tracking engine . using the alhambra browser , we present two security policies that we have built using our architecture , both designed to prevent cross-site scripting . the first policy uses a taint-tracking engine to prevent cross-site scripting attacks that exploit bugs in the client-side of the web applications . the second one uses browsing history to create policies that restrict the contents of documents and prevent the inclusion of malicious content . using alhambra we analyze the impact of policies on the compatibility of web pages . to test compatibility , alhambra supports revisiting user-generated browsing sessions and comparing multiple security policies in parallel to quickly and automatically evaluate security policies . to compare security policies for identical pages we have also developed useful comparison metrics that quantify differences between identical pages executed with different security policies . not only do we show that our policies are effective with minimal compatibility cost , we also demonstrate that alhambra can enforce strong security policies and provide quantitative evaluation of the differences introduced by security policies . 