automatic detection of fragments in dynamically generated web pages dividing web pages into fragments has been shown to provide significant benefits for both content generation and caching . in order for a web site to use fragment-based content generation , however , good methods are needed for dividing web pages into fragments . manual fragmentation of web pages is expensive , error prone , and unscalable . this paper proposes a novel scheme to automatically detect and flag fragments that are cost-effective cache units in web sites serving dynamic content . we consider the fragments to be interesting if they are shared among multiple documents or they have different lifetime or personalization characteristics . our approach has three unique features . first , we propose a hierarchical and fragment-aware model of the dynamic web pages and a data structure that is compact and effective for fragment detection . second , we present an efficient algorithm to detect maximal fragments that are shared among multiple documents . third , we develop a practical algorithm that effectively detects fragments based on their lifetime and personalization characteristics . we evaluate the proposed scheme through a series of experiments , showing the benefits and costs of the algorithms . we also study the impact of adopting the fragments detected by our system on disk space utilization and network bandwidth consumption . 