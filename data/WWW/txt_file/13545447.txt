a general framework for adaptive and online detection of web attacks detection of web attacks is an important issue in current defense-in-depth security framework . in this paper , we propose a novel general framework for adaptive and online detection of web attacks . the general framework can be based on any online clustering methods . a detection model based on the framework is able to learn online and deal with `` concept drift '' in web audit data streams . str-dbscan that we extended dbscan to streaming data as well as strap are both used to validate the framework . the detection model based on the framework automatically labels the web audit data and adapts to normal behavior changes while identifies attacks through dynamical clustering of the streaming data . a very large size of real http log data collected in our institute is used to validate the framework and the model . the preliminary testing results demonstrated its effectiveness . 